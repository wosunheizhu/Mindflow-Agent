# 📝 提示词识别功能使用指南

## ✅ 已修复问题

### 问题描述
系统之前只识别**双花括号** `{{...}}` 格式的提示词，导致单花括号格式无法被识别。

### 修复内容
现在系统**同时支持**以下两种格式：
- ✅ 单花括号：`{...}`
- ✅ 双花括号：`{{...}}`

---

## 🎯 如何使用

### 方法1：通过数字员工语音交互

1. **打开应用**
   ```
   http://localhost:3000
   ```

2. **点击左侧数字员工框的语音按钮** 🎤

3. **说出您的需求**，包含提示词格式：

   **示例A（单花括号）**：
   ```
   马上处理 {请搜索2024-2025年人工智能技术最新发展，重点关注大语言模型、多模态AI、Agent系统三个方向。生成一份结构化报告约2000字，包含：技术概述与核心突破、主要应用场景、行业影响分析、未来发展趋势。使用Markdown格式，引用可靠来源。}
   ```

   **示例B（双花括号）**：
   ```
   帮我执行 {{搜索最新的AI Agent技术发展，生成详细报告}}
   ```

4. **系统会自动**：
   - 🎤 识别您的语音
   - 🤖 数字员工处理并提取提示词
   - 📤 将任务发送给 Agentic AI
   - ⚙️ Agent执行工具调用（搜索、分析、生成）
   - 📊 返回完整结果

---

## 🧪 测试示例

### 示例1：AI技术报告（您的需求）
```
{请搜索2024-2025年人工智能技术最新发展，重点关注大语言模型、多模态AI、Agent系统三个方向。生成一份结构化报告约2000字，包含：技术概述与核心突破、主要应用场景、行业影响分析、未来发展趋势。使用Markdown格式，引用可靠来源。}
```

**预期效果**：
- ✅ Agent调用 `search_web` 工具搜索最新AI技术
- ✅ 分析搜索结果
- ✅ 生成结构化Markdown报告
- ✅ 包含技术概述、应用场景、影响分析、趋势预测

---

### 示例2：数据分析任务
```
{用Python生成2024年销售数据，创建柱状图和折线图，生成Excel报告}
```

**预期效果**：
- ✅ Agent调用 `execute_code` 生成数据
- ✅ Agent调用 `create_bar_chart` 创建图表
- ✅ Agent调用 `create_excel` 生成报告
- ✅ 返回所有文件的下载链接

---

### 示例3：简单搜索
```
{搜索Next.js 15的新特性}
```

**预期效果**：
- ✅ Agent调用 `search_web`
- ✅ 返回搜索结果摘要

---

## 🔍 调试日志

系统会在控制台输出详细日志，帮助您了解处理过程：

```javascript
// 实时检测阶段
🤖 [实时] 检测到完整提示词，立即发送: 请搜索2024-2025年人工智能技术...
📊 [实时] promptSent当前状态: false
📨 [实时] 已发送 avatar_agent_task 事件

// 或者在完成阶段
🤖 [done] 检测到 Agentic AI 提示词（长度: 150）: 请搜索2024-2025年人工智能...
📨 [done] 已发送 avatar_agent_task 事件
```

---

## 📱 界面改进

### 1. Logo位置调整
✅ "Mindflow Agent" 已向左移动，布局更紧凑

**修改内容**：
- 容器左边距：`-ml-2` → `-ml-4`
- 元素间距：`gap-1` → `gap-0`
- 图标和文字添加 `-ml-1` 负边距

---

## 🎯 完整测试流程

### Step 1: 启动服务
```bash
# 确保前后端都在运行
# 前端: http://localhost:3000
# 后端: http://localhost:8001
```

### Step 2: 打开数字员工
- 左侧边栏找到数字员工卡片
- 选择您喜欢的音色（小岚/小远）

### Step 3: 语音输入
1. 点击 🎤 麦克风按钮
2. 说出您的指令（包含提示词）
3. 等待数字员工识别和处理

### Step 4: 查看结果
- 数字员工会先给出简短回应
- 然后自动触发 Agent 执行任务
- 在右侧聊天界面查看 Agent 的执行过程
- 查看工具调用和最终结果

---

## ⚠️ 注意事项

1. **提示词格式**：
   - ✅ 使用 `{...}` 或 `{{...}}`
   - ❌ 不要遗漏花括号
   - ✅ 提示词内容要清晰明确

2. **语音质量**：
   - 🎤 保持环境安静
   - 📢 清晰地说出指令
   - ⏱️ 不要说得太快

3. **任务复杂度**：
   - 简单任务：1-2个工具调用
   - 复杂任务：可能需要多轮执行
   - Agent会自动规划和执行

---

## 🚀 立即测试

现在您可以尝试您的原始需求了：

**语音输入**：
```
帮我搜索 AI 技术并生成报告。马上处理。

{请搜索2024-2025年人工智能技术最新发展，重点关注大语言模型、多模态AI、Agent系统三个方向。生成一份结构化报告约2000字，包含：技术概述与核心突破、主要应用场景、行业影响分析、未来发展趋势。使用Markdown格式，引用可靠来源。}
```

**预期结果**：
1. 🎤 数字员工识别语音
2. 🤖 提取并识别提示词
3. 📤 发送任务给 Agentic AI
4. 🔍 Agent 调用 search_web 搜索相关信息
5. 📝 Agent 整理并生成报告
6. 📊 返回完整的Markdown格式报告

---

## 📞 问题反馈

如果遇到问题，请检查：
1. ✅ 浏览器控制台是否有日志输出
2. ✅ 提示词格式是否正确
3. ✅ 语音服务是否正常运行
4. ✅ API密钥是否配置正确

**日志位置**：
- 前端：浏览器开发者工具 Console
- 后端：`voice_server.log`

---

**更新时间**: 2025-10-30
**版本**: v1.1 - 支持单/双花括号提示词识别

