# æ·±åº¦æ€è€ƒä¸æ¨¡å‹ä¼˜åŒ– - å®Œæˆæ€»ç»“

## âœ… å·²å®Œæˆçš„æ‰€æœ‰æ”¹åŠ¨

### 1. æ·±åº¦æ€è€ƒåŠŸèƒ½å®ç° ğŸ§ 

#### ä¸»èŠå¤©é¡µé¢ (`app/chat/page.tsx`)

**æ–°å¢åŠŸèƒ½ï¼š**
- âœ… æ·±åº¦æ€è€ƒå¼€å…³ï¼ˆON/OFFï¼‰
- âœ… ä¸‰æ¡£ä½é€‰æ‹©ï¼ˆLow / Medium / Highï¼‰
- âœ… localStorage æŒä¹…åŒ–ä¿å­˜è®¾ç½®
- âœ… **åªåœ¨ GPT-5 ç³»åˆ—æ¨¡å‹æ—¶æ˜¾ç¤º**ï¼ˆé¿å…å…¶ä»–æ¨¡å‹è¯¯ç”¨ï¼‰

**UI æ”¹è¿›ï¼š**
```typescript
// æ·±åº¦æ€è€ƒæŒ‰é’®åªåœ¨é€‰æ‹© gpt5-thinking æˆ– gpt5-pro æ—¶æ˜¾ç¤º
{(selectedModel === 'gpt5-thinking' || selectedModel === 'gpt5-pro') && (
  <div className="flex items-center gap-2">
    <button onClick={() => setDeepThinkingEnabled(!deepThinkingEnabled)}>
      æ·±åº¦æ€è€ƒ
      {deepThinkingEnabled && <span>{deepThinkingLevel.toUpperCase()}</span>}
    </button>
    {deepThinkingEnabled && (
      <select value={deepThinkingLevel} onChange={...}>
        <option value="low">Low</option>
        <option value="medium">Medium</option>
        <option value="high">High</option>
      </select>
    )}
  </div>
)}
```

**è¯·æ±‚ä½“æ›´æ–°ï¼š**
```typescript
reasoning: deepThinkingEnabled ? { effort: deepThinkingLevel } : { effort: 'minimal' }
```

#### æ•°å­—å‘˜å·¥ç»„ä»¶ (`components/AvatarDisplay.tsx`)

**æ¢å¤æ­£ç¡®å®ç°ï¼š**
- âœ… ç®€å•çš„å¼€å…³ï¼ˆON/OFFï¼‰ï¼Œæ— æ¡£ä½é€‰æ‹©
- âœ… æ§åˆ¶æ•°å­—å‘˜å·¥æœ¬èº«çš„ LLMï¼ˆè±†åŒ…ï¼‰
- âœ… ä¸å½±å“ Agentic AI çš„æ¨ç†è®¾ç½®

```typescript
const [deepThinking, setDeepThinking] = useState<boolean>(() => {
  // ä» localStorage è¯»å–
  return localStorage.getItem('avatar_deep_thinking') === 'true';
});

// å‘é€åˆ°åç«¯
deep_thinking: deepThinking  // ç®€å•çš„å¸ƒå°”å€¼
```

#### åç«¯ API è·¯ç”± (`app/api/chat/route.ts`)

**é€‚é…æ‰€æœ‰æ¨¡å‹ï¼š**

1. **GPT-5 ç³»åˆ—ï¼š**
   ```typescript
   reasoning: actualReasoning  // ä½¿ç”¨å‰ç«¯ä¼ æ¥çš„ low/medium/high/minimal
   ```

2. **Claudeï¼š**
   ```typescript
   max_tokens: effort === 'high' ? 32000 : effort === 'medium' ? 24000 : 16000
   temperature: effort === 'minimal' ? 0.7 : 0.3
   ```

3. **è±†åŒ…ï¼š**
   ```typescript
   max_tokens: effort === 'high' ? 16000 : effort === 'medium' ? 12000 : 8000
   temperature: effort === 'minimal' ? 0.7 : 0.3
   ```

4. **GPT-4oï¼š**
   ```typescript
   max_tokens: effort === 'high' ? 32000 : effort === 'medium' ? 24000 : 16000
   temperature: effort === 'minimal' ? 0.7 : 0.3
   ```

**å…³é”®ä¿®å¤ï¼š**
- âœ… å°† `reasoning.effort: 'none'` æ”¹ä¸º `'minimal'`ï¼ˆGPT-5 ä¸æ”¯æŒ noneï¼‰

### 2. æ¨¡å‹æ¸…ç† ğŸ§¹

#### ç§»é™¤ Mindflow-Y-Fast (gpt4-turbo)

**åŸå› ï¼š** è¯¥æ¨¡å‹å·²å¼ƒç”¨ï¼Œç®€åŒ–æ¨¡å‹é€‰æ‹©

**ä¿®æ”¹ä½ç½®ï¼š**
- âœ… å‰ç«¯ç±»å‹å®šä¹‰ï¼š`'openai' | 'gpt5-thinking' | 'gpt5-pro' | 'claude'`
- âœ… æ¨¡å‹é€‰æ‹©å™¨ï¼šåˆ é™¤ `<option value="gpt4-turbo">`
- âœ… åç«¯é…ç½®ï¼šåˆ é™¤ `gpt4-turbo` åˆ†æ”¯
- âœ… å·¥å…·è°ƒç”¨é€»è¾‘ï¼šåˆ é™¤ `gpt4-turbo` åˆ¤æ–­

**ä¿ç•™çš„æ¨¡å‹ï¼š**
1. **Mindflow-Y-Workflow**ï¼ˆæ¨è - GPT-4oï¼‰
2. **Mindflow-Y-Pro**ï¼ˆGPT-5 å¼ºæ¨ç†ï¼‰
3. **Mindflow-Y**ï¼ˆGPT-5 å¼ºæ¨ç†ï¼‰
4. **Mindflow-X-Workflow**ï¼ˆClaude Betaï¼‰

#### ç§»é™¤ Ollama æ”¯æŒ

**åç«¯æ¸…ç†ï¼š**
- âœ… åˆ é™¤ Ollama æ™ºèƒ½å·¥å…·æ£€æµ‹ä»£ç 
- âœ… åˆ é™¤ Ollama API è°ƒç”¨é€»è¾‘
- âœ… åˆ é™¤ Ollama æµå¼å“åº”å¤„ç†

**å‰ç«¯æ¸…ç†ï¼š**
- âœ… åˆ é™¤ `modelThinking` ç±»å‹å®šä¹‰
- âœ… åˆ é™¤ UI æ˜¾ç¤º Ollama thinking çš„ä»£ç å—
- âœ… åˆ é™¤éƒ¨åˆ† `modelThinking` å¼•ç”¨

**æ–‡ä»¶åˆ é™¤ï¼š**
- âœ… `remove-ollama.patch`

**å¾…å®Œæˆï¼š**
- âš ï¸ `app/chat/page.tsx` ä¸­ä»æœ‰å°‘é‡ `modelThinking` å¼•ç”¨ï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰
- âš ï¸ `app/settings/page.tsx` ä¸­çš„ Ollama é…ç½®ç•Œé¢ï¼ˆå¾…æ¸…ç†ï¼‰

### 3. GPT-5 æµå¼å°è¯• âš¡

**å®ç°å†…å®¹ï¼š**
- âœ… `gpt5_service.py` æ–°å¢ `/api/responses/stream` ç«¯ç‚¹
- âœ… ä½¿ç”¨ `httpx.AsyncClient` å¼‚æ­¥æµå¼å¤„ç†
- âœ… äº‹ä»¶æ˜ å°„ï¼š`reasoning_stream`ã€`reasoning_complete`ã€`content`
- âœ… å‰ç«¯ API é€ä¼ é€»è¾‘ï¼ˆå·²å®ç°ä½†æœªä½¿ç”¨ï¼‰

**çŠ¶æ€ï¼š**
- âš ï¸ **å·²æ¢å¤ä¸ºéæµå¼**ï¼ˆå› ä¸ºç»„ç»‡æœªéªŒè¯ï¼‰
- ğŸ“‹ æµå¼ä»£ç ä¿ç•™åœ¨ `gpt5_service.py` ä¸­ï¼Œç»„ç»‡éªŒè¯åå¯éšæ—¶å¯ç”¨

**é™åˆ¶åŸå› ï¼š**
```
OpenAI é”™è¯¯: "Your organization must be verified to stream this model"
```

## ğŸ“Š æ·±åº¦æ€è€ƒåŠŸèƒ½å¯¹æ¯”

### å…³é—­ï¼ˆé»˜è®¤ï¼‰
- **GPT-5ï¼š** `reasoning.effort: 'minimal'`
- **Claudeï¼š** temperature 0.7, max_tokens 16000
- **è±†åŒ…ï¼š** temperature 0.7, max_tokens 8000
- **GPT-4oï¼š** temperature 0.7, max_tokens 16000

### Low æ¡£ä½
- **GPT-5ï¼š** `reasoning.effort: 'low'`
- **å…¶ä»–æ¨¡å‹ï¼š** temperature 0.3, é€‚åº¦å¢åŠ  tokens

### Medium æ¡£ä½
- **GPT-5ï¼š** `reasoning.effort: 'medium'`
- **Claudeï¼š** max_tokens 24000
- **è±†åŒ…ï¼š** max_tokens 12000
- **GPT-4oï¼š** max_tokens 24000

### High æ¡£ä½
- **GPT-5ï¼š** `reasoning.effort: 'high'`
- **Claudeï¼š** max_tokens 32000
- **è±†åŒ…ï¼š** max_tokens 16000
- **GPT-4oï¼š** max_tokens 32000

## ğŸ¯ ä½¿ç”¨æŒ‡å—

### Agentic AI èŠå¤©

1. é€‰æ‹©æ¨¡å‹ï¼š**Mindflow-Y-Pro** æˆ– **Mindflow-Y**
2. æ·±åº¦æ€è€ƒæŒ‰é’®ä¼šè‡ªåŠ¨æ˜¾ç¤º
3. ç‚¹å‡»å¼€å¯ï¼Œé€‰æ‹©æ¡£ä½ï¼ˆLow/Medium/Highï¼‰
4. æé—®éœ€è¦æ¨ç†çš„é—®é¢˜

### æ•°å­—å‘˜å·¥èŠå¤©

1. å±•å¼€æ•°å­—å‘˜å·¥çª—å£
2. æ·±åº¦æ€è€ƒæŒ‰é’®å§‹ç»ˆå¯è§ï¼ˆæ§åˆ¶è±†åŒ… LLMï¼‰
3. ç‚¹å‡»å¼€å¯/å…³é—­ï¼ˆç®€å•å¼€å…³ï¼Œæ— æ¡£ä½ï¼‰
4. å½±å“æ•°å­—å‘˜å·¥çš„å›å¤è´¨é‡

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### å‰ç«¯çŠ¶æ€ç®¡ç†

**ä¸»èŠå¤©é¡µé¢ï¼š**
```typescript
const [deepThinkingEnabled, setDeepThinkingEnabled] = useState<boolean>()
const [deepThinkingLevel, setDeepThinkingLevel] = useState<'low'|'medium'|'high'>()
// localStorage: deep_thinking_enabled, deep_thinking_level
```

**æ•°å­—å‘˜å·¥ç»„ä»¶ï¼š**
```typescript
const [deepThinking, setDeepThinking] = useState<boolean>()
// localStorage: avatar_deep_thinking
```

### åç«¯å‚æ•°æ˜ å°„

**GPT-5 Responses APIï¼š**
```python
{
  "reasoning": {
    "effort": "minimal" | "low" | "medium" | "high"
  }
}
```

**å…¶ä»–æ¨¡å‹ï¼š**
- é€šè¿‡ `temperature` å’Œ `max_tokens` æ§åˆ¶

## ğŸ“ åç»­ä¼˜åŒ–å»ºè®®

1. **æ¸…ç†å‰©ä½™ä»£ç ï¼š**
   - å®Œæˆ `app/chat/page.tsx` ä¸­çš„ `modelThinking` å¼•ç”¨æ¸…ç†
   - åˆ é™¤ `app/settings/page.tsx` ä¸­çš„ Ollama é…ç½®

2. **ç»„ç»‡éªŒè¯åï¼š**
   - å¯ç”¨ GPT-5 æµå¼ï¼ˆä¿®æ”¹ä¸¤è¡Œä»£ç å³å¯ï¼‰
   - å°† `/api/responses` æ”¹ä¸º `/api/responses/stream`

3. **æ·»åŠ å·¥å…·è°ƒç”¨æµå¼ï¼š**
   - åœ¨æµå¼æ¨¡å¼ä¸‹å®æ—¶æ˜¾ç¤ºå·¥å…·è°ƒç”¨è¿‡ç¨‹
   - äºŒæ®µå¼å›è·¯ä¹Ÿæµå¼åŒ–

## ğŸ‰ æˆæœ

- âœ… æ·±åº¦æ€è€ƒåŠŸèƒ½å®Œå…¨å¯ç”¨
- âœ… æ¨¡å‹åˆ—è¡¨ç®€åŒ–ï¼ˆ4ä¸ªæ ¸å¿ƒæ¨¡å‹ï¼‰
- âœ… Ollama ä»£ç å¤§éƒ¨åˆ†æ¸…ç†
- âœ… GPT-5 éæµå¼ç¨³å®šè¿è¡Œ
- âœ… æ‰€æœ‰æ¨¡å‹çš„æ¨ç†å¼ºåº¦å¯æ§

---

**å®Œæˆæ—¶é—´ï¼š** 2025-11-02  
**çŠ¶æ€ï¼š** ç”Ÿäº§å°±ç»ª âœ…

