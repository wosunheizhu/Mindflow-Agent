# 最终环境变量配置清单

## 🎯 所有需要配置的 Vercel 环境变量

访问：https://vercel.com/dashboard → 你的项目 → Settings → Environment Variables

---

### 1. GPT-5 服务（修复强推理模型）

```
Name: GPT5_SERVICE_URL
Value: https://mindflow-agent-production.up.railway.app
Environments: ✅ Production ✅ Preview ✅ Development
```

⚠️ **重要**：必须包含 `https://` 前缀！

---

### 2. Carbone API Key（启用 PPT 生成）

```
Name: CARBONE_API_KEY
Value: eyJhbGciOiJFUzUxMiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiIxMjgwNTA3MDU0OTEyNzYxNzQ5IiwiYXVkIjoiY2FyYm9uZSIsImV4cCI6MjQyNDM2MzcyNiwiZGF0YSI6eyJ0eXBlIjoicHJvZCJ9fQ.AXMe7WXAYhGjU_7e4WkzUt0kZh6JMkm1LCisatVC8JUYsuYXG9rnf25JQ0VPSdxhPlcL13incPWhwmwD8Lukq5erAVT82zfx3B7IlsZWPlYFck70gnomK14NDHfUjzThydanBP5AhQ6mTLA7XiFmPwndJMoOhedIQmkf3IHLUHoO_gLg
Environments: ✅ Production ✅ Preview ✅ Development
```

---

### 3. Carbone PPT 模板 ID（Google Slides 模板）

```
Name: CARBONE_PPT_TEMPLATE_ID
Value: c8d8f73e74ed42cd55f31ed9a4a74ce3042b824faade8c97b35c438525373738
Environments: ✅ Production ✅ Preview ✅ Development
```

⚠️ **这是新的模板 ID**，使用你的 Google Slides 转换的模板！

---

## 📊 完整环境变量列表

你的 Vercel 项目应该有以下环境变量：

```bash
# OpenAI（必需）
OPENAI_API_KEY=sk-proj-你的密钥
OPENAI_BASE_URL=https://api.openai.com/v1

# GPT-5 服务（必需，修复强推理模型）
GPT5_SERVICE_URL=https://mindflow-agent-production.up.railway.app

# Carbone PPT（必需，启用 PPT 生成）
CARBONE_API_KEY=eyJhbGciOiJFUzUxMiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiIxMjgwNTA3MDU0OTEyNzYxNzQ5IiwiYXVkIjoiY2FyYm9uZSIsImV4cCI6MjQyNDM2MzcyNiwiZGF0YSI6eyJ0eXBlIjoicHJvZCJ9fQ.AXMe7WXAYhGjU_7e4WkzUt0kZh6JMkm1LCisatVC8JUYsuYXG9rnf25JQ0VPSdxhPlcL13incPWhwmwD8Lukq5erAVT82zfx3B7IlsZWPlYFck70gnomK14NDHfUjzThydanBP5AhQ6mTLA7XiFmPwndJMoOhedIQmkf3IHLUHoO_gLg
CARBONE_PPT_TEMPLATE_ID=c8d8f73e74ed42cd55f31ed9a4a74ce3042b824faade8c97b35c438525373738

# Vercel Blob Storage（推荐，文件下载）
BLOB_READ_WRITE_TOKEN=（在 Storage 标签自动生成）

# 语音服务（可选）
NEXT_PUBLIC_VOICE_SERVER_URL=https://你的语音服务.railway.app

# 其他可选
ANTHROPIC_API_KEY=sk-ant-你的密钥（可选）
BRAVE_API_KEY=你的密钥（可选）
```

---

## 🚀 配置完成后操作

### 步骤1：保存所有环境变量

点击 **Save** 保存每个环境变量

### 步骤2：重新部署 Vercel

**重要**：添加/修改环境变量后必须重新部署！

1. **Deployments** 标签
2. 点击最新部署的 **...** 菜单
3. 选择 **Redeploy**
4. 等待 1-2 分钟

---

## 🧪 部署后测试

### 测试1：GPT-5 工作流

```
访问：/gpt5-debug.html
点击：测试 GPT-5 调用
期望：✅ 响应状态 200，收到内容
```

或主页面：
```
选择模型：Mindflow-Y-Pro
输入："搜索 AI 技术并生成 Word 报告"
期望：完整执行搜索→分析→生成文档
```

### 测试2：Carbone PPT（Google Slides 模板）

```
输入："生成一个 AI 技术介绍 PPT"

期望：
✅ 生成 1.6MB 的 PPTX 文件
✅ 使用 Google Slides 的专业设计
✅ 可正常打开
✅ 保留所有样式和布局
```

### 测试3：Excel 表格

```
输入："生成一个 AI 技术对比表格"

期望：
✅ 正确的多行多列
✅ 表头在第一行
✅ 数据分布在各列
✅ 列宽自动调整
```

### 测试4：数字员工

```
输入："我要看看图表"

期望：
✅ 发送提示词给 Agent
✅ 生成图表 HTML
✅ 生成数据 CSV
✅ 两个下载链接（蓝色按钮）
```

---

## 📁 测试文件（查看效果）

```bash
# Google Slides 模板生成的 PPT
open /tmp/google-slides-test.pptx

# 应该看到：
# - 专业的设计和样式
# - 标题页
# - 内容页（已填充测试数据）
```

---

## ✅ 配置检查清单

- [ ] 添加 `GPT5_SERVICE_URL`（带 https://）
- [ ] 添加 `CARBONE_API_KEY`
- [ ] 添加 `CARBONE_PPT_TEMPLATE_ID`（新的 Google Slides 模板）
- [ ] 确认所有环境变量应用于 Production/Preview/Development
- [ ] 点击 Save
- [ ] Redeploy Vercel
- [ ] 等待部署完成
- [ ] 清除浏览器缓存
- [ ] 测试所有功能

---

## 🎉 完成后的效果

- ✅ 强推理模型（GPT-5）完整工作流
- ✅ 专业 PPT 生成（Google Slides 设计）
- ✅ 正确的 Excel 表格（多行多列）
- ✅ Word 文档生成
- ✅ 图表 + CSV 数据
- ✅ 智能链接分类
- ✅ 数字员工交互

---

**现在去 Vercel 控制台配置这3个环境变量，然后 Redeploy！** 🚀

所有代码已就绪，配置完成后立即可用！

