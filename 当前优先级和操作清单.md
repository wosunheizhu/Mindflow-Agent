# 当前优先级和操作清单

## 🔴 紧急（立即修复）

### 问题：GPT-5 模型无响应

**根本原因**：Vercel 环境变量缺少 `https://` 前缀

**修复方法**（1分钟）：

1. **Vercel 控制台** → mindflow-agent → **Settings** → **Environment Variables**
2. **编辑 `GPT5_SERVICE_URL`**
3. **改为**：
   ```
   https://mindflow-agent-production.up.railway.app
   ```
   （前面加 `https://`）
4. **Save**
5. **Deployments → Redeploy**
6. 等待 1-2 分钟
7. 刷新网站测试

**验证**：访问 `/gpt5-debug.html` 测试，应该不再显示 "Failed to parse URL"

---

## 🟡 重要（等待部署）

### 问题：PPT 生成失败

**根本原因**：Vercel 环境尝试创建 `/var/task/outputs` 目录失败

**修复状态**：
- ✅ 代码已修复（使用 /tmp 目录）
- ✅ 已推送到 GitHub
- ⏳ 等待 Vercel 自动部署

**验证**：
部署完成后测试生成 PPT，不应该再报 "ENOENT: no such file or directory"

---

## 🟢 优化（可选，后续）

### Carbone PPT 集成

**当前状态**：
- ✅ API Key 已提供
- ✅ 基础代码框架已创建（`lib/carbone-ppt.ts`）
- ⏳ 需要创建和上传模板

**下一步**（如果 Aspose PPT 质量不满意）：

1. **设计通用 ODP 模板**
   - 标题页
   - 内容页（支持循环）
   - 总结页

2. **上传模板到 Carbone**
   ```bash
   curl -X POST 'https://api.carbone.io/template' \
     -H 'Authorization: Bearer YOUR_KEY' \
     -H 'carbone-version: 4' \
     -F 'template=@template.odp'
   ```

3. **获取 templateId**

4. **完整集成代码**

5. **替换 createPresentation 函数**

**预计时间**：2-3 小时（需要设计模板）

---

## ✅ 今天已完成的所有工作

1. ✅ 链接分类显示（下载链接蓝色）
2. ✅ Word 文档生成（docx.js）
3. ✅ 图表 CSV 数据文件
4. ✅ 文件预览空白修复
5. ✅ UI 对齐修复
6. ✅ 数字员工任务识别优化
7. ✅ AI 质量要求提升
8. ✅ Railway 端口配置
9. ✅ Vercel 文件路径修复
10. ✅ GPT-5 错误处理增强
11. ✅ 调试工具和测试页面

---

## 🎯 立即操作顺序

### 第一优先级：GPT-5 连接（1分钟）

```
Vercel → 编辑 GPT5_SERVICE_URL → 加 https:// → Redeploy
```

### 第二优先级：等待部署（2-3分钟）

```
等待 Vercel 自动部署完成
```

### 第三优先级：测试所有功能（5分钟）

1. **测试 GPT-5 模型**
   - 访问 `/gpt5-debug.html`
   - 或主页面选择 Mindflow-Y-Pro

2. **测试 PPT 生成**
   - "生成一个 AI 技术的 PPT"

3. **测试 Word 生成**
   - "生成一份 Word 报告"

4. **测试数字员工**
   - "我要看看图表"

---

## 📋 Carbone 集成计划（可选）

### 如果 Aspose PPT 质量不满意

**阶段1：准备模板**（1小时）
- 使用 LibreOffice Impress 创建 ODP 模板
- 添加 Carbone 占位符
- 设计 2-3 个通用布局

**阶段2：上传模板**（10分钟）
- 上传到 Carbone Cloud
- 获取 templateId
- 保存到环境变量

**阶段3：代码集成**（30分钟）
- 完善 `lib/carbone-ppt.ts`
- 替换 `createPresentation` 调用
- 测试验证

**阶段4：部署测试**（10分钟）
- 推送代码
- 测试生成质量
- 对比 Aspose 和 Carbone

---

## 💡 建议

### 今天先完成

1. ✅ 修复 GPT-5 连接（加 https://）
2. ✅ 等待 Vercel 部署
3. ✅ 测试所有功能（包括 Aspose PPT）

### 明天或后续

4. 🔄 如果 PPT 质量不满意，再集成 Carbone
5. 🔄 设计和上传模板
6. 🔄 完整替换

---

## 🎯 当前最紧急

**立即去 Vercel 修改 `GPT5_SERVICE_URL`，加上 `https://`！**

这是导致强推理模型无响应的根本原因。

修复后，所有功能（包括 PPT）应该都能正常工作了！

---

**Carbone 集成可以作为后续优化，不影响当前功能使用！** 🚀

