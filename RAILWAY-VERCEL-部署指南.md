# ğŸš€ Railway + Vercel éƒ¨ç½²å®Œæ•´æŒ‡å—

## ğŸ“‹ éƒ¨ç½²æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç”¨æˆ·è®¿é—®                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Vercel (å‰ç«¯ + API Routes)                      â”‚
â”‚  â€¢ Next.js åº”ç”¨                                  â”‚
â”‚  â€¢ /app/api/chat (å¯¹è¯API)                       â”‚
â”‚  â€¢ /app/api/tools (å·¥å…·API)                      â”‚
â”‚  â€¢ é™æ€èµ„æºæ‰˜ç®¡                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“ (APIè°ƒç”¨)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Railway (Python åç«¯)                           â”‚
â”‚  â€¢ è¯­éŸ³è¯†åˆ« (ASR)                                â”‚
â”‚  â€¢ è¯­éŸ³åˆæˆ (TTS)                                â”‚
â”‚  â€¢ LLM-TTS åŒå‘æµå¼                              â”‚
â”‚  â€¢ æ•°å­—å‘˜å·¥æœåŠ¡                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… éƒ¨ç½²å‰å‡†å¤‡æ¸…å•

### 1. å¿…éœ€çš„APIå¯†é’¥

åœ¨éƒ¨ç½²å‰ï¼Œè¯·ç¡®ä¿æ‚¨å·²ç»è·å–ä»¥ä¸‹APIå¯†é’¥ï¼š

```bash
# AIæœåŠ¡
OPENAI_API_KEY=sk-proj-xxxxx           # OpenAI (å¿…éœ€)
ANTHROPIC_API_KEY=sk-ant-xxxxx         # Claude (å¯é€‰)

# æœç´¢æœåŠ¡
BRAVE_API_KEY=BSAOiXxxxxx              # Brave Search (å¿…éœ€)

# è±†åŒ…æœåŠ¡ (è¯­éŸ³åŠŸèƒ½)
ARK_API_KEY=xxxxx                      # è±†åŒ…/ç«å±±æ–¹èˆŸ (å¿…éœ€)
```

### 2. æ£€æŸ¥é¡¹ç›®æ–‡ä»¶

ç¡®ä¿ä»¥ä¸‹æ–‡ä»¶å­˜åœ¨ï¼š
- âœ… `vercel.json` - Vercel é…ç½®
- âœ… `railway.json` - Railway é…ç½®  
- âœ… `requirements.txt` - Python ä¾èµ–
- âœ… `Procfile` - Railway å¯åŠ¨å‘½ä»¤
- âœ… `.vercelignore` - Vercel å¿½ç•¥æ–‡ä»¶
- âœ… `.gitignore` - Git å¿½ç•¥æ–‡ä»¶

---

## ğŸ¯ ç¬¬ä¸€æ­¥ï¼šéƒ¨ç½² Python åç«¯åˆ° Railway

### 1.1 å‡†å¤‡ Railway é¡¹ç›®

1. **è®¿é—® Railway**
   ```
   https://railway.app/
   ```

2. **åˆ›å»ºæ–°é¡¹ç›®**
   - ç‚¹å‡» "New Project"
   - é€‰æ‹© "Deploy from GitHub repo"
   - è¿æ¥æ‚¨çš„ GitHub è´¦å·
   - é€‰æ‹©è¿™ä¸ªé¡¹ç›®ä»“åº“

### 1.2 é…ç½®ç¯å¢ƒå˜é‡

åœ¨ Railway é¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

```bash
# è±†åŒ…/ç«å±±æ–¹èˆŸ API
ARK_API_KEY=ä½ çš„è±†åŒ…APIå¯†é’¥

# å¯é€‰ï¼šå¦‚æœéœ€è¦å…¶ä»–AIæ¨¡å‹
OPENAI_API_KEY=ä½ çš„OpenAIå¯†é’¥

# Pythonç¯å¢ƒ
PYTHONUNBUFFERED=1
```

### 1.3 Railway é…ç½®è¯´æ˜

Railway ä¼šè‡ªåŠ¨æ£€æµ‹ `railway.json` å’Œ `requirements.txt`ï¼š

**railway.json** (å·²é…ç½®):
```json
{
  "build": {
    "builder": "NIXPACKS"
  },
  "deploy": {
    "startCommand": "python voice_server.py",
    "restartPolicyType": "ON_FAILURE",
    "restartPolicyMaxRetries": 10
  }
}
```

### 1.4 è·å– Railway æœåŠ¡ URL

éƒ¨ç½²å®Œæˆåï¼š
1. è¿›å…¥ Railway é¡¹ç›®
2. ç‚¹å‡» "Settings" 
3. åœ¨ "Domains" éƒ¨åˆ†ç‚¹å‡» "Generate Domain"
4. å¤åˆ¶ç”Ÿæˆçš„ URLï¼Œæ ¼å¼ç±»ä¼¼ï¼š
   ```
   https://your-app.railway.app
   ```

**ä¿å­˜è¿™ä¸ªURLï¼Œä¸‹ä¸€æ­¥éœ€è¦ç”¨åˆ°ï¼**

---

## ğŸŒ ç¬¬äºŒæ­¥ï¼šéƒ¨ç½²å‰ç«¯åˆ° Vercel

### 2.1 å‡†å¤‡ Vercel é¡¹ç›®

1. **è®¿é—® Vercel**
   ```
   https://vercel.com/
   ```

2. **å¯¼å…¥é¡¹ç›®**
   - ç‚¹å‡» "Add New..." â†’ "Project"
   - ä» GitHub å¯¼å…¥é¡¹ç›®
   - é€‰æ‹©è¿™ä¸ªä»“åº“

### 2.2 é…ç½®ç¯å¢ƒå˜é‡

åœ¨ Vercel é¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ç¯å¢ƒå˜é‡ï¼š

#### å¿…éœ€çš„ç¯å¢ƒå˜é‡

```bash
# OpenAI API
OPENAI_API_KEY=sk-proj-xxxxx

# Brave Search API
BRAVE_API_KEY=BSAOiXxxxxx

# Railway Python åç«¯åœ°å€ (é‡è¦ï¼)
VOICE_SERVER_URL=https://your-app.railway.app

# å…¶ä»–å¯é€‰
ANTHROPIC_API_KEY=sk-ant-xxxxx          # å¦‚æœä½¿ç”¨ Claude
ARK_API_KEY=xxxxx                        # è±†åŒ…API (ç”¨äºæŸäº›åŠŸèƒ½)
```

#### å¦‚ä½•æ·»åŠ ç¯å¢ƒå˜é‡

1. è¿›å…¥ Vercel é¡¹ç›®è®¾ç½®
2. ç‚¹å‡» "Settings" â†’ "Environment Variables"
3. æ·»åŠ ä¸Šè¿°æ‰€æœ‰å˜é‡
4. é€‰æ‹©é€‚ç”¨ç¯å¢ƒï¼šProduction, Preview, Development

### 2.3 æ„å»ºè®¾ç½®

Vercel ä¼šè‡ªåŠ¨æ£€æµ‹ Next.js é¡¹ç›®ï¼Œé»˜è®¤è®¾ç½®é€šå¸¸æ­£ç¡®ï¼š

```bash
Framework Preset: Next.js
Build Command: pnpm run build
Output Directory: .next
Install Command: pnpm install
```

å¦‚æœæ‚¨ä½¿ç”¨ npmï¼š
```bash
Build Command: npm run build
Install Command: npm install
```

### 2.4 éƒ¨ç½²

1. ç‚¹å‡» "Deploy"
2. ç­‰å¾…æ„å»ºå®Œæˆï¼ˆé€šå¸¸ 2-5 åˆ†é’Ÿï¼‰
3. è·å–æ‚¨çš„åº”ç”¨ URLï¼š
   ```
   https://your-app.vercel.app
   ```

---

## ğŸ”§ ç¬¬ä¸‰æ­¥ï¼šéªŒè¯éƒ¨ç½²

### 3.1 æµ‹è¯•å‰ç«¯

è®¿é—®æ‚¨çš„ Vercel URLï¼š
```
https://your-app.vercel.app
```

**æ£€æŸ¥é¡¹ç›®**ï¼š
- âœ… é¡µé¢æ­£å¸¸åŠ è½½
- âœ… å¯ä»¥çœ‹åˆ° Mindflow Agent ç•Œé¢
- âœ… ä¾§è¾¹æ å¯¼èˆªæ­£å¸¸

### 3.2 æµ‹è¯•åç«¯è¿æ¥

1. **æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°**ï¼ˆF12ï¼‰

2. **æµ‹è¯•èŠå¤©åŠŸèƒ½**
   - åœ¨èŠå¤©é¡µé¢è¾“å…¥é—®é¢˜
   - æŸ¥çœ‹æ˜¯å¦èƒ½æ­£å¸¸å›å¤

3. **æµ‹è¯•æ•°å­—å‘˜å·¥**ï¼ˆå¦‚æœé…ç½®äº†è¯­éŸ³æœåŠ¡ï¼‰
   - ç‚¹å‡»æ•°å­—å‘˜å·¥å¡ç‰‡
   - å°è¯•è¯­éŸ³è¾“å…¥
   - æŸ¥çœ‹æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯

### 3.3 å¸¸è§é—®é¢˜æ£€æŸ¥

**å¦‚æœèŠå¤©æ— æ³•å·¥ä½œ**ï¼š
```bash
# æ£€æŸ¥ Vercel ç¯å¢ƒå˜é‡
1. OPENAI_API_KEY æ˜¯å¦æ­£ç¡®
2. BRAVE_API_KEY æ˜¯å¦æ­£ç¡®
3. è¿›å…¥ Vercel Dashboard â†’ Settings â†’ Environment Variables ç¡®è®¤
```

**å¦‚æœè¯­éŸ³åŠŸèƒ½æ— æ³•å·¥ä½œ**ï¼š
```bash
# æ£€æŸ¥è¿æ¥
1. VOICE_SERVER_URL æ˜¯å¦æ­£ç¡®è®¾ç½®ä¸º Railway URL
2. Railway æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
3. æ‰“å¼€ Railway Dashboard æŸ¥çœ‹æ—¥å¿—
```

---

## ğŸ“Š ç¬¬å››æ­¥ï¼šç›‘æ§å’Œæ—¥å¿—

### 4.1 æŸ¥çœ‹ Vercel æ—¥å¿—

```
Vercel Dashboard â†’ é€‰æ‹©é¡¹ç›® â†’ Deployments â†’ ç‚¹å‡»éƒ¨ç½² â†’ Function Logs
```

### 4.2 æŸ¥çœ‹ Railway æ—¥å¿—

```
Railway Dashboard â†’ é€‰æ‹©é¡¹ç›® â†’ Deployments â†’ View Logs
```

### 4.3 å®æ—¶ç›‘æ§

**Vercel**:
- æŸ¥çœ‹å‡½æ•°è°ƒç”¨æ¬¡æ•°
- æŸ¥çœ‹é”™è¯¯ç‡
- æŸ¥çœ‹å“åº”æ—¶é—´

**Railway**:
- CPU ä½¿ç”¨ç‡
- å†…å­˜ä½¿ç”¨é‡
- è¯·æ±‚å“åº”æ—¶é—´

---

## ğŸ”„ ç¬¬äº”æ­¥ï¼šæ›´æ–°éƒ¨ç½²

### 5.1 è‡ªåŠ¨éƒ¨ç½²

å½“æ‚¨æ¨é€ä»£ç åˆ° GitHubï¼š

**Vercel**ï¼š
- è‡ªåŠ¨æ£€æµ‹ Git æ¨é€
- è‡ªåŠ¨æ„å»ºå’Œéƒ¨ç½²
- Preview éƒ¨ç½²ï¼ˆPRï¼‰
- Production éƒ¨ç½²ï¼ˆmain åˆ†æ”¯ï¼‰

**Railway**ï¼š
- è‡ªåŠ¨æ£€æµ‹ Git æ¨é€
- è‡ªåŠ¨é‡æ–°æ„å»º
- é›¶åœæœºéƒ¨ç½²

### 5.2 æ‰‹åŠ¨éƒ¨ç½²

**Vercel**ï¼š
```bash
# å®‰è£… Vercel CLI
npm i -g vercel

# éƒ¨ç½²
vercel --prod
```

**Railway**ï¼š
```bash
# å®‰è£… Railway CLI
npm i -g @railway/cli

# ç™»å½•
railway login

# éƒ¨ç½²
railway up
```

---

## ğŸ’° æˆæœ¬ä¼°ç®—

### Vercelï¼ˆå…è´¹å±‚ï¼‰
- âœ… 100GB å¸¦å®½/æœˆ
- âœ… æ— é™éƒ¨ç½²
- âœ… è‡ªåŠ¨ HTTPS
- âœ… å…¨çƒ CDN
- âš ï¸ å‡½æ•°æ‰§è¡Œæ—¶é—´: 10ç§’ï¼ˆHobbyï¼‰ï¼Œ60ç§’ï¼ˆProï¼‰

### Railwayï¼ˆå…è´¹å±‚ï¼‰
- âœ… $5 å…è´¹é¢åº¦/æœˆ
- âœ… 512MB RAM
- âœ… 1GB ç£ç›˜
- âœ… å…±äº« CPU
- âš ï¸ çº¦å¯è¿è¡Œ 500 å°æ—¶/æœˆ

**é¢„è®¡æœˆæˆæœ¬**: $0-10 (å–å†³äºä½¿ç”¨é‡)

---

## âš™ï¸ ä¼˜åŒ–å»ºè®®

### æ€§èƒ½ä¼˜åŒ–

1. **å¯ç”¨ç¼“å­˜**
```typescript
// next.config.mjs
export default {
  reactStrictMode: true,
  swcMinify: true,
  compress: true,
}
```

2. **ä¼˜åŒ–å›¾ç‰‡**
```typescript
// ä½¿ç”¨ Next.js Image ç»„ä»¶
import Image from 'next/image'
```

3. **å‡å°‘æ‰“åŒ…ä½“ç§¯**
```bash
# æ£€æŸ¥æ‰“åŒ…ä½“ç§¯
npm run build
npx next-bundle-analyzer
```

### å®‰å…¨ä¼˜åŒ–

1. **ç¯å¢ƒå˜é‡**
   - âœ… æ°¸è¿œä¸è¦æäº¤ `.env.local` åˆ° Git
   - âœ… ä½¿ç”¨å¹³å°çš„ç¯å¢ƒå˜é‡ç®¡ç†
   - âœ… å®šæœŸè½®æ¢ API å¯†é’¥

2. **CORS é…ç½®**
   - Railway åç«¯å·²é…ç½® CORS
   - ç¡®ä¿åªå…è®¸æ‚¨çš„ Vercel åŸŸå

3. **é€Ÿç‡é™åˆ¶**
   - è€ƒè™‘æ·»åŠ  API é€Ÿç‡é™åˆ¶
   - é˜²æ­¢æ»¥ç”¨

---

## ğŸ› å¸¸è§é—®é¢˜è§£å†³

### é—®é¢˜1ï¼šVercel æ„å»ºå¤±è´¥

**åŸå› **ï¼šä¾èµ–å®‰è£…å¤±è´¥

**è§£å†³**ï¼š
```bash
# åˆ é™¤ node_modules å’Œ lock æ–‡ä»¶
rm -rf node_modules package-lock.json pnpm-lock.yaml

# é‡æ–°å®‰è£…
pnpm install

# æäº¤æ›´æ–°
git add .
git commit -m "fix: update dependencies"
git push
```

### é—®é¢˜2ï¼šRailway Python æœåŠ¡å¯åŠ¨å¤±è´¥

**åŸå› **ï¼šrequirements.txt é—®é¢˜

**è§£å†³**ï¼š
```bash
# æ£€æŸ¥ requirements.txt
cat requirements.txt

# ç¡®ä¿æ ¼å¼æ­£ç¡®ï¼Œæ²¡æœ‰å¤šä½™ç©ºæ ¼
# æ¨é€æ›´æ–°
git add requirements.txt
git commit -m "fix: update python requirements"
git push
```

### é—®é¢˜3ï¼šCORS é”™è¯¯

**åŸå› **ï¼šRailway åç«¯ä¸å…è®¸ Vercel åŸŸå

**è§£å†³**ï¼š
åœ¨ Railway ç¯å¢ƒå˜é‡ä¸­æ·»åŠ ï¼š
```bash
FRONTEND_URL=https://your-app.vercel.app
```

### é—®é¢˜4ï¼šè¯­éŸ³åŠŸèƒ½ 404

**åŸå› **ï¼šVOICE_SERVER_URL é…ç½®é”™è¯¯

**è§£å†³**ï¼š
1. æ£€æŸ¥ Railway URL æ˜¯å¦æ­£ç¡®
2. åœ¨ Vercel è®¾ç½®æ­£ç¡®çš„ VOICE_SERVER_URL
3. é‡æ–°éƒ¨ç½² Vercel

---

## ğŸ“š éƒ¨ç½²æ£€æŸ¥æ¸…å•

éƒ¨ç½²å‰è¯·ç¡®è®¤ï¼š

### Vercel é…ç½®
- [ ] GitHub ä»“åº“å·²è¿æ¥
- [ ] `OPENAI_API_KEY` å·²è®¾ç½®
- [ ] `BRAVE_API_KEY` å·²è®¾ç½®
- [ ] `VOICE_SERVER_URL` å·²è®¾ç½®ï¼ˆRailway URLï¼‰
- [ ] æ„å»ºå‘½ä»¤æ­£ç¡®
- [ ] ç¯å¢ƒå˜é‡åº”ç”¨åˆ° Production

### Railway é…ç½®
- [ ] GitHub ä»“åº“å·²è¿æ¥
- [ ] `ARK_API_KEY` å·²è®¾ç½®
- [ ] `requirements.txt` å­˜åœ¨
- [ ] `railway.json` é…ç½®æ­£ç¡®
- [ ] Domain å·²ç”Ÿæˆ
- [ ] æœåŠ¡æ­£å¸¸è¿è¡Œ

### åŠŸèƒ½æµ‹è¯•
- [ ] å‰ç«¯é¡µé¢æ­£å¸¸åŠ è½½
- [ ] AI å¯¹è¯åŠŸèƒ½æ­£å¸¸
- [ ] å·¥å…·è°ƒç”¨åŠŸèƒ½æ­£å¸¸
- [ ] è¯­éŸ³åŠŸèƒ½æ­£å¸¸ï¼ˆå¦‚æœéœ€è¦ï¼‰
- [ ] å›¾ç‰‡ç”Ÿæˆæ­£å¸¸
- [ ] æœç´¢åŠŸèƒ½æ­£å¸¸

---

## ğŸ‰ éƒ¨ç½²å®Œæˆï¼

æ­å–œï¼æ‚¨çš„ Mindflow Agent ç°å·²éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒï¼

**æ‚¨çš„åº”ç”¨åœ°å€**ï¼š
- ğŸŒ å‰ç«¯ï¼š`https://your-app.vercel.app`
- ğŸ”§ åç«¯ï¼š`https://your-app.railway.app`

**ä¸‹ä¸€æ­¥**ï¼š
1. åˆ†äº«ç»™ç”¨æˆ·ä½¿ç”¨
2. ç›‘æ§ä½¿ç”¨æƒ…å†µ
3. æ ¹æ®éœ€æ±‚æ‰©å±•åŠŸèƒ½
4. ä¼˜åŒ–æ€§èƒ½å’Œæˆæœ¬

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

é‡åˆ°é—®é¢˜ï¼Ÿ

1. **æŸ¥çœ‹æ—¥å¿—**
   - Vercel: Function Logs
   - Railway: Deployment Logs

2. **æ£€æŸ¥ç¯å¢ƒå˜é‡**
   - æ‰€æœ‰å¯†é’¥æ˜¯å¦æ­£ç¡®
   - URL æ˜¯å¦é…ç½®æ­£ç¡®

3. **æµ‹è¯• API**
   ```bash
   # æµ‹è¯• Railway åç«¯
   curl https://your-app.railway.app/health
   
   # æµ‹è¯• Vercel å‰ç«¯
   curl https://your-app.vercel.app/api/health
   ```

---

**éƒ¨ç½²æ—¶é—´**: é¢„è®¡ 15-30 åˆ†é’Ÿ  
**éš¾åº¦**: â­â­â­ (ä¸­ç­‰)  
**æˆåŠŸç‡**: 95%+

ç¥æ‚¨éƒ¨ç½²é¡ºåˆ©ï¼ğŸš€

